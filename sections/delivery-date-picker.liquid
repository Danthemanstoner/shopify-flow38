{% schema %}
    {
      "name": "Delivery Date and Time Picker",
      "settings": [
        {
          "type": "text",
          "id": "section_title",
          "label": "Section Title",
          "default": "Choose Your Delivery Date and Time"
        }
      ],
      "presets": [
        {
          "name": "Delivery Date and Time Picker"
        }
      ]
    }
    {% endschema %}
    
    <div class="delivery-date-time-picker">
      <h2>{{ section.settings.section_title }}</h2>
    
      <!-- Delivery Date Picker -->
      <label for="delivery-date-picker-input">Select Delivery Date:</label>
      <input type="text" id="delivery-date-picker-input" placeholder="Select a date">
    
      <!-- Time Slot Selector -->
      <label for="delivery-time-slot">Select Delivery Time:</label>
      <select id="delivery-time-slot">
        <option value="" disabled selected>Select a time</option>
        <option value="08:00-10:00">08:00 AM - 10:00 AM</option>
        <option value="10:00-12:00">10:00 AM - 12:00 PM</option>
        <option value="12:00-14:00">12:00 PM - 02:00 PM</option>
        <option value="14:00-16:00">02:00 PM - 04:00 PM</option>
        <option value="16:00-18:00">04:00 PM - 06:00 PM</option>
      </select>
    </div>
    
    <style>
    .delivery-date-time-picker {
      margin-top: 20px;
    }
    
    .delivery-date-time-picker h2 {
      font-size: 1.5em;
      margin-bottom: 10px;
    }
    
    #delivery-date-picker-input,
    #delivery-time-slot {
      width: 100%;
      padding: 10px;
      font-size: 1em;
      margin-top: 10px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    </style>
    
    <!-- Flatpickr Date Picker -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      const datePickerInput = document.getElementById('delivery-date-picker-input');
      const timeSlotInput = document.getElementById('delivery-time-slot');
    
      let selectedDate = '';
      let selectedTimeSlot = '';
    
      // Initialize Flatpickr for the date picker
      if (datePickerInput) {
        flatpickr(datePickerInput, {
          dateFormat: 'Y-m-d',
          minDate: 'today', // Prevent selecting past dates
          onChange: function(selectedDates, dateStr, instance) {
            selectedDate = dateStr;
            console.log('Selected date:', selectedDate);
            if (selectedDate && selectedTimeSlot) {
              addCartAttributes(selectedDate, selectedTimeSlot);
            }
          }
        });
      }
    
      // Listen for time slot changes
      timeSlotInput.addEventListener('change', function() {
        selectedTimeSlot = this.value;
        console.log('Selected time slot:', selectedTimeSlot);
        if (selectedDate && selectedTimeSlot) {
          addCartAttributes(selectedDate, selectedTimeSlot);
        }
      });
    
      // Function to add selected date and time to the cart
      function addCartAttributes(date, timeSlot) {
        fetch('/cart/update.js', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            attributes: {
              'Delivery Date': date,
              'Delivery Time Slot': timeSlot,
            },
          }),
        })
        .then(response => response.json())
        .then(data => {
          console.log('Cart updated with delivery details:', data);
        })
        .catch(error => {
          console.error('Error updating cart:', error);
        });
      }
    });
    </script>
    